---
title: 'Process Chat Message'
description: 'Send messages to the AI chatbot for interactive content generation and conversation'
---

## Overview

The chatbot endpoint provides an interactive AI interface for content generation, social media post creation, and general conversation. It supports multiple modes for different types of content creation workflows.

<Info>
The chatbot supports both single-response and streaming modes. For real-time applications, use the streaming endpoint for better user experience.
</Info>

## Supported Modes

<Tabs>
<Tab title="prompt2post">
Generate social media posts from text prompts
</Tab>

<Tab title="image2post">
Create posts based on uploaded images
</Tab>

<Tab title="url2post">
Generate content from webpage URLs
</Tab>

<Tab title="quote2post">
Transform quotes into engaging social media posts
</Tab>

</Tabs>

## Request

<ParamField path="message" type="object" required>
The user's message to process

<Expandable title="Message Structure">
<ParamField path="message.message" type="string" required>
The text content of the user's message
</ParamField>

<ParamField path="message.attachments[]" type="array">
List of attachments. Each item requires `type` and `url`.
</ParamField>

<ParamField path="message.attachments[].type" type="string">
Attachment type. One of: `image`, `video`, `audio`, `document`.
</ParamField>

<ParamField path="message.attachments[].url" type="string">
Publicly accessible URL of the attachment.
</ParamField>

<ParamField path="message.metadata" type="object">
Additional metadata for the message (e.g., platform preferences, style guides).
</ParamField>

<ParamField path="message.metadata.resume" type="string">
Confirmation value to resume an interrupted run (e.g., "yes").
</ParamField>
</Expandable>
</ParamField>

<ParamField path="mode" type="string" default="chat">
Processing mode. One of: `prompt2post`, `image2post`, `url2post`, `quote2post`.
</ParamField>

<ParamField path="thread_id" type="string">
ID of the conversation thread for context continuity
</ParamField>

<ParamField path="user_background" type="object">
User's background information and preferences

<Expandable title="User Background Fields">
<ParamField path="industry" type="string">
User's industry or business sector
</ParamField>

<ParamField path="tone" type="string">
Preferred communication tone: `professional`, `casual`, `friendly`, `authoritative`
</ParamField>

<ParamField path="target_audience" type="string">
Description of the target audience
</ParamField>

<ParamField path="brand_voice" type="string">
Brand voice characteristics and guidelines
</ParamField>

<ParamField path="platforms" type="array">
Preferred social media platforms
</ParamField>
</Expandable>
</ParamField>

<ParamField path="preview_posts" type="array">
Existing posts for context or comparison

<Expandable title="Post Preview Structure">
<ParamField path="platform" type="string">
Platform where the post will be shared
</ParamField>

<ParamField path="post_content" type="string">
Post content/caption
</ParamField>

<ParamField path="post_image_url" type="string">
URL to the post image
</ParamField>

<ParamField path="post_hashtags" type="array">
List of hashtags
</ParamField>
</Expandable>
</ParamField>

<ParamField path="is_dummy_mode" type="boolean" default="false">
Enable dummy mode for testing and development
</ParamField>

<ParamField path="session_id" type="string">
Session identifier for request tracking
</ParamField>

## Response

<ResponseField name="id" type="string">
Unique identifier for the chatbot response
</ResponseField>

<ResponseField name="thread_id" type="string">
ID of the message thread
</ResponseField>

<ResponseField name="type" type="string">
Response type: `message`, `post_generation`, `error`
</ResponseField>

<ResponseField name="role" type="string">
Response role: `assistant`, `system`
</ResponseField>

<ResponseField name="status" type="string">
Response status: `success`, `failed`, `processing`
</ResponseField>

<ResponseField name="model" type="string">
AI model used for processing
</ResponseField>

<ResponseField name="content" type="array">
Response content blocks

<Expandable title="Content Block Types">
<ResponseField name="type" type="string">
Content type: `text`, `image`, `post`, `suggestions`, `tool_use`
</ResponseField>

<ResponseField name="text" type="string">
Text content (for text blocks)
</ResponseField>

<ResponseField name="image_url" type="string">
Image URL (for image blocks)
</ResponseField>

<ResponseField name="post_data" type="object">
Generated post data (for post blocks)
</ResponseField>

<ResponseField name="tool_use" type="object">
Tool invocation data. When an image generation/edit requires confirmation, a block with `name: "await_confirmation"` is returned and `input` contains the confirmation question.
</ResponseField>
</Expandable>
</ResponseField>

<ResponseField name="suggestions" type="array">
Follow-up suggestions or actions
</ResponseField>

<ResponseField name="processing_time" type="number">
Time taken to process the request in seconds
</ResponseField>

<ResponseField name="usage" type="object">
Token usage summary for the completed run
</ResponseField>

<ResponseField name="stop_reason" type="string">
Reason the response ended: `end_turn`, `max_tokens`, `stop_sequence`, `tool_use`, or `interrupted`.
</ResponseField>

<ResponseField name="error" type="string">
Error message if processing failed
</ResponseField>

## Examples

<AccordionGroup>
<Accordion title="Basic Chat Interaction">

<RequestExample>
```bash cURL
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages' \
  -H 'Content-Type: application/json' \
  -H 'X-Session-ID: session_123' \
  -d '{
    "message": {
      "message": "Help me create a LinkedIn post about the benefits of remote work",
      "attachments": []
    },
    "mode": "prompt2post",
    "user_background": {
      "industry": "Technology",
      "tone": "professional",
      "target_audience": "Software developers and tech professionals",
      "platforms": ["linkedin"]
    }
  }'
```
</RequestExample>

<ResponseExample>
```json Success Response
{
  "id": "chat_response_789",
  "thread_id": "thread_456",
  "type": "post_generation",
  "role": "assistant",
  "status": "success",
  "model": "claude-3-sonnet",
  "content": [
    {
      "type": "text",
      "text": "I've created a professional LinkedIn post about remote work benefits tailored for tech professionals:"
    },
    {
      "type": "post",
      "post_data": {
        "platform": "linkedin",
        "content": "üè† Remote work has transformed the tech industry in remarkable ways.\n\nKey benefits I've observed:\n\n‚úÖ Increased productivity with fewer office distractions\n‚úÖ Better work-life balance leading to reduced burnout\n‚úÖ Access to global talent pools for companies\n‚úÖ Reduced commute time = more time for skill development\n‚úÖ Cost savings for both employees and employers\n\nThe data speaks for itself: 83% of developers report higher job satisfaction when working remotely.\n\nWhat's been your biggest win with remote work? Share your experience below! üëá\n\n#RemoteWork #TechCareers #WorkLifeBalance #SoftwareDevelopment",
        "hashtags": ["#RemoteWork", "#TechCareers", "#WorkLifeBalance", "#SoftwareDevelopment"],
        "engagement_prediction": 89.5
      }
    }
  ],
  "suggestions": [
    "Would you like me to create versions for other platforms?",
    "I can generate an accompanying image for this post",
    "Should we schedule this post for optimal engagement timing?"
  ],
  "processing_time": 3.24,
  "usage": {
    "input_tokens": 157,
    "output_tokens": 312,
    "total_tokens": 469
  },
  "stop_reason": "end_turn"
}
```
</ResponseExample>
</Accordion>

<Accordion title="Image generation confirmation interrupt">

<RequestExample>
```bash cURL
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages' \
  -H 'Content-Type: application/json' \
  -d '{
    "message": {
      "message": "Create a Facebook post and generate an image about weekend brunch specials"
    },
    "mode": "prompt2post",
    "thread_id": "thread_abc123"
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "id": "chat_response_901",
  "thread_id": "thread_abc123",
  "type": "message",
  "role": "assistant",
  "status": "success",
  "content": [
    {
      "type": "tool_use",
      "id": "chatbot_tool_use_1",
      "name": "await_confirmation",
      "input": "I can generate an image for this post. Do you want me to proceed?"
    }
  ],
  "suggestions": [
    "Say yes to generate image",
    "Ask to change the image concept"
  ],
  "processing_time": 1.02,
  "usage": {},
  "stop_reason": "interrupted"
}
```
</ResponseExample>
</Accordion>

<Accordion title="Resume after confirmation">

<RequestExample>
```bash cURL
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages' \
  -H 'Content-Type: application/json' \
  -d '{
    "message": {
      "message": "yes",
      "metadata": { "resume": "yes" }
    },
    "thread_id": "thread_abc123",
    "mode": "prompt2post"
  }'
```
</RequestExample>

<ResponseExample>
```json Success
{
  "id": "chat_response_902",
  "thread_id": "thread_abc123",
  "type": "post_generation",
  "role": "assistant",
  "status": "success",
  "content": [
    {
      "type": "post",
      "post_data": {
        "platform": "facebook",
        "content": "ü•û Weekend Brunch Specials...",
        "hashtags": ["#Brunch", "#WeekendVibes"],
        "engagement_prediction": 82.1
      }
    },
    {
      "type": "image",
      "image_url": "https://cdn.postreach.ai/images/brunch_123.png"
    }
  ],
  "suggestions": [
    "Generate platform variants",
    "Schedule this post"
  ],
  "processing_time": 6.44,
  "usage": {},
  "stop_reason": "end_turn"
}
```
</ResponseExample>
</Accordion>

<Accordion title="URL to Post Generation">

<RequestExample>
```bash cURL
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages' \
  -H 'Content-Type: application/json' \
  -H 'X-Session-ID: session_456' \
  -d '{
    "message": {
      "message": "https://techcrunch.com/2024/01/15/ai-startup-funding-record"
    },
    "mode": "url2post",
    "user_background": {
      "industry": "Venture Capital",
      "tone": "authoritative",
      "target_audience": "Investors and entrepreneurs",
      "platforms": ["twitter", "linkedin"]
    },
    "thread_id": "thread_789"
  }'
```
</RequestExample>

<ResponseExample>
```json URL Processing Response
{
  "id": "chat_response_890",
  "thread_id": "thread_789",
  "type": "post_generation",
  "role": "assistant",
  "status": "success",
  "model": "claude-3-sonnet",
  "content": [
    {
      "type": "text",
      "text": "I've analyzed the TechCrunch article about AI startup funding and created posts for both Twitter and LinkedIn:"
    },
    {
      "type": "post",
      "post_data": {
        "platform": "twitter",
        "content": "üöÄ AI startup funding just hit a new record!\n\nKey insights from the latest data:\n‚Ä¢ $2.3B invested in Q4 2024\n‚Ä¢ 47% increase from previous quarter\n‚Ä¢ Generative AI leading the charge\n\nThe AI revolution is well-funded and accelerating üìà\n\nWhat sectors do you think will see the biggest AI disruption next?\n\n#AIFunding #VentureCapital #StartupNews",
        "hashtags": ["#AIFunding", "#VentureCapital", "#StartupNews"],
        "engagement_prediction": 92.3
      }
    },
    {
      "type": "post",
      "post_data": {
        "platform": "linkedin",
        "content": "The AI funding landscape continues to break records, with $2.3B invested in Q4 2024 alone - a 47% quarter-over-quarter increase.\n\nWhat's driving this unprecedented growth?\n\nüîπ Generative AI applications showing real ROI\nüîπ Enterprise adoption accelerating across industries\nüîπ Infrastructure needs creating new opportunities\nüîπ Talent acquisition wars driving valuations\n\nAs investors, we're seeing a clear shift from experimental to production-ready AI solutions. The companies succeeding aren't just building cool tech - they're solving real business problems with measurable impact.\n\nThe question isn't whether AI will transform industries, but how quickly and which startups will lead that transformation.\n\nWhat AI applications are you most excited about in 2024?\n\n#ArtificialIntelligence #VentureCapital #StartupInvesting #TechTrends",
        "hashtags": ["#ArtificialIntelligence", "#VentureCapital", "#StartupInvesting", "#TechTrends"],
        "engagement_prediction": 87.8
      }
    }
  ],
  "processing_time": 8.76,
  "usage": {
    "input_tokens": 1243,
    "output_tokens": 567,
    "total_tokens": 1810
  },
  "stop_reason": "end_turn"
}
```
</ResponseExample>
</Accordion>

<Accordion title="Conversation with Context">

<RequestExample>
```bash cURL
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages' \
  -H 'Content-Type: application/json' \
  -H 'X-Session-ID: session_789' \
  -d '{
    "message": {
      "message": "Can you make the LinkedIn post more data-driven and add specific statistics?"
    },
    "mode": "chat",
    "thread_id": "thread_789"
  }'
```
</RequestExample>

<ResponseExample>
```json Context-Aware Response
{
  "id": "chat_response_891",
  "thread_id": "thread_789",
  "type": "message",
  "role": "assistant",
  "status": "success",
  "content": [
    {
      "type": "text",
      "text": "Absolutely! Here's the LinkedIn post enhanced with specific data points and statistics:"
    },
    {
      "type": "post",
      "post_data": {
        "platform": "linkedin",
        "content": "AI funding just shattered records: $2.3B invested in Q4 2024 üìä\n\nThe numbers tell a compelling story:\n\nüìà 47% QoQ growth (vs 23% average for tech overall)\nüí∞ Average deal size: $12.4M (up 31% from Q3)\nüéØ 74% of deals focused on generative AI applications\n‚ö° Enterprise adoption up 156% year-over-year\nüè¢ 83% of Fortune 500 companies now have AI pilot programs\n\nMost telling statistic: AI startups are achieving profitability 2.3x faster than the previous generation of tech companies.\n\nBreakdown by sector:\n‚Ä¢ Healthcare AI: $680M (29.6%)\n‚Ä¢ Developer tools: $520M (22.6%)\n‚Ä¢ Sales & marketing: $410M (17.8%)\n‚Ä¢ Cybersecurity: $390M (17.0%)\n‚Ä¢ Other: $300M (13.0%)\n\nWe're witnessing the maturation of AI from experimental technology to business-critical infrastructure. The startups raising these rounds aren't just building features - they're creating new market categories.\n\nSource: TechCrunch Analysis, Q4 2024 Funding Report\n\nWhich AI sector do you predict will dominate 2025 funding rounds?\n\n#AIFunding #VentureCapital #StartupData #TechTrends #GenerativeAI",
        "engagement_prediction": 94.2
      }
    }
  ],
  "suggestions": [
    "Create a visual chart showing the sector breakdown",
    "Write a follow-up post about AI profitability metrics",
    "Compare these numbers to previous AI funding cycles"
  ],
  "processing_time": 4.12,
  "usage": {
    "input_tokens": 89,
    "output_tokens": 423,
    "total_tokens": 512
  },
  "stop_reason": "end_turn"
}
```
</ResponseExample>

</Accordion>

</AccordionGroup>

## Streaming Response

For real-time applications, use the streaming endpoint to receive responses as they're generated.

<RequestExample>
```bash cURL Streaming
curl -X POST 'https://api.postreach.ai/api/v1/chatbot/messages/stream' \
  -H 'Content-Type: application/json' \
  -H 'X-Session-ID: session_123' \
  -H 'Accept: text/event-stream' \
  -d '{
    "message": {
      "message": "Create a Twitter thread about sustainable technology trends"
    },
    "mode": "chat2post"
  }'
```
</RequestExample>

<ResponseExample>
```json Streaming Response
data: {"event": "start", "data": {"thread_id": "thread_abc123"}}

data: {"event": "content", "data": {"type": "text", "content": "I'll create a Twitter thread about sustainable technology trends. Here's the thread:"}}

data: {"event": "content", "data": {"type": "post", "content": "üå± THREAD: Sustainable tech trends reshaping our future\n\n1/7 The intersection of technology and sustainability isn't just a trend‚Äîit's becoming the foundation of innovation in 2024."}}

data: {"event": "content", "data": {"type": "post", "content": "2/7 üîã Energy Storage Revolution\n‚Ä¢ Solid-state batteries achieving 2x energy density\n‚Ä¢ Grid-scale storage costs down 70% since 2020\n‚Ä¢ Breakthrough: 15-minute charging for EVs"}}

data: {"event": "done", "data": {"usage": {"total_tokens": 456}, "processing_time": 12.3}}
```
</ResponseExample>

## Interrupts and confirmation flow

<Steps>
<Step title="Agent asks for confirmation">
When an image generation or editing step requires approval, the response stops with `stop_reason: interrupted` and returns a `tool_use` block named `await_confirmation` with a human-readable question in `input`.
</Step>

<Step title="Client sends confirmation to resume">
Send a follow-up request to the same `thread_id` with `message.metadata.resume` set to your confirmation string (e.g., `"yes"`). The agent resumes from the interrupted node and continues the workflow.

```json
{
  "message": {
    "message": "yes",
    "metadata": { "resume": "yes" }
  },
  "thread_id": "<same-thread-id>",
  "mode": "prompt2post"
}
```
</Step>

<Step title="Quote mode bypasses confirmation">
For `quote2post`, image generation may proceed without confirmation.
</Step>
</Steps>

## Error Handling

<Warning>
The chatbot can fail due to content policy violations, rate limiting, or processing errors. Always implement proper error handling.
</Warning>

### Common Error Scenarios

<AccordionGroup>
<Accordion title="Content Policy Violation">
```json
{
  "status": "failed",
  "error": "Content policy violation: The requested content contains inappropriate material that cannot be processed.",
  "error_code": "CONTENT_POLICY_VIOLATION"
}
```
</Accordion>

<Accordion title="Rate Limit Exceeded">
```json
{
  "status": "failed",
  "error": "Rate limit exceeded. Please wait 60 seconds before making another request.",
  "error_code": "RATE_LIMIT_EXCEEDED",
  "retry_after": 60
}
```
</Accordion>

<Accordion title="Invalid Mode">
```json
{
  "status": "failed",
  "error": "Invalid mode: 'invalid_mode'. Supported modes: prompt2post, image2post, url2post, quote2post",
  "error_code": "INVALID_MODE"
}
```
</Accordion>
</AccordionGroup>

## Best Practices

<Steps>
<Step title="Use Thread IDs for Context">
Always include `thread_id` for multi-turn conversations to maintain context.

<Check>
Store thread IDs in your application to enable conversation continuity.
</Check>
</Step>

<Step title="Provide Rich User Background">
Include detailed user background information for more personalized responses.

<Tip>
The more context you provide about industry, audience, and tone preferences, the better the generated content will be.
</Tip>
</Step>

<Step title="Handle Streaming Responses">
For better user experience, implement streaming response handling for real-time feedback.

```javascript
const eventSource = new EventSource('/api/v1/chatbot/messages/stream');
eventSource.onmessage = function(event) {
  const data = JSON.parse(event.data);
  // Handle streaming content
};
```
</Step>
</Steps>
